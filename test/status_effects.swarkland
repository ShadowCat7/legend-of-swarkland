@test
!monster lich player 3 1
wait
!wish wand confusion
  @rng 2 range:4:8:wand_charges
pickup 0000000000000000000000000000000000000000000000000000000000000003
!polymorph air_elemenetal
wait
# confusion wand doesn't appear to affect me
@mark_events
  zap -1 0 0000000000000000000000000000000000000000000000000000000000000003
    @rng 6 inclusive:6:12:beam_length
    @rng 100 range:100:200:confusion_duration
  @expect_event "a lich king zaps a bone wand."
  @expect_event "a magic beam hits you."
  @expect_event "a magic beam hits a wall."
  @expect_no_events
# this should not ask for rng for confusion
move 0 1
move 0 -1
wait
# change back into a human
!polymorph human
wait # let our movement speed recharge
wait # ...
wait # lich does nothing

@mark_events
  move 0 1
    @rng 0 int:2:is_direction_confused
    @rng 1 int:2:confused_direction
  @expect_event "you bumps into a wall."
  @expect_no_events
wait
